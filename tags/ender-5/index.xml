<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ender 5 on Всякое</title><link>/tags/ender-5/</link><description>Recent content in ender 5 on Всякое</description><generator>Hugo -- gohugo.io</generator><language>ru</language><lastBuildDate>Thu, 01 Jun 2023 09:06:16 +0400</lastBuildDate><atom:link href="/tags/ender-5/index.xml" rel="self" type="application/rss+xml"/><item><title>Сборка Marlin 2.x для Ender 5 Pro</title><link>/posts/ender-5-pro-marlin/</link><pubDate>Thu, 01 Jun 2023 09:06:16 +0400</pubDate><guid>/posts/ender-5-pro-marlin/</guid><description>Исходный сетап Ender 5 Pro OctoPrint на Raspberry PI 3 BL-Touch для принтеров CR-10/CR-10S/CR-10 V2/Ender-3/Ender-3 Pro/Ender-3 V2 Silent Mainboard Ender-5 Pro v4.22 Подготовка (VSCode, PlatformIO, Auto Build Marlin) Все по мануалу из этого видоса
Готовим исходники mkdir ~/src/Marlin git clone https://github.com/MarlinFirmware/Marlin ~/src/Marlin/Marlin git clone https://github.com/MarlinFirmware/Configurations \ ~/src/Marlin/Configurations cd ~/Marlin/ cp Configurations/config/examples/Creality/Ender-5\ Pro/CrealityV422/* \ Marlin/Marlin/ источник
Редактируем и собираем Открываем ~/src/Marlin/Marlin как PlatformIO как показано в видосике ссылка на который была выше и генерируем среду сборки как там показно.</description><content>&lt;h2 id="исходный-сетап">Исходный сетап&lt;/h2>
&lt;ol>
&lt;li>Ender 5 Pro&lt;/li>
&lt;li>&lt;a href="https://octoprint.org/">OctoPrint&lt;/a> на Raspberry PI 3&lt;/li>
&lt;li>BL-Touch для принтеров CR-10/CR-10S/CR-10 V2/Ender-3/Ender-3 Pro/Ender-3 V2&lt;/li>
&lt;li>Silent Mainboard Ender-5 Pro v4.22&lt;/li>
&lt;/ol>
&lt;h2 id="подготовка-vscode-platformio-auto-build-marlin">Подготовка (VSCode, PlatformIO, Auto Build Marlin)&lt;/h2>
&lt;p>Все по мануалу из &lt;a href="https://www.youtube.com/watch?v=_tnVl4X2p20">этого видоса&lt;/a>&lt;/p>
&lt;h2 id="готовим-исходники">Готовим исходники&lt;/h2>
&lt;pre tabindex="0">&lt;code>mkdir ~/src/Marlin
git clone https://github.com/MarlinFirmware/Marlin ~/src/Marlin/Marlin
git clone https://github.com/MarlinFirmware/Configurations \
~/src/Marlin/Configurations
cd ~/Marlin/
cp Configurations/config/examples/Creality/Ender-5\ Pro/CrealityV422/* \
Marlin/Marlin/
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://lodge.glasgownet.com/2021/08/17/compiling-marlin-firmware-for-the-ender-5-pro-v4-2-2-board-with-bltouch/">источник&lt;/a>&lt;/p>
&lt;h2 id="редактируем-и-собираем">Редактируем и собираем&lt;/h2>
&lt;p>Открываем ~/src/Marlin/Marlin как PlatformIO как показано в видосике ссылка на который была выше и генерируем среду сборки как там показно.&lt;/p>
&lt;p>в VS Code открываем ~/src/Marlin/Marlin/Marlin/Configuration.h и правим там тупо всего 4 строки&lt;/p>
&lt;ol>
&lt;li>Комментим два error в начале&lt;/li>
&lt;li>Раcкоменчиваем &lt;code>#define ENDER5_USE_BLTOUCH&lt;/code>&lt;/li>
&lt;li>Коментим &lt;code>#define Z_MIN_PROBE_USES_Z_MIN_ENDSTOP_PIN&lt;/code> (потому что плата 4.2.2 с 5-pin header)&lt;/li>
&lt;/ol>
&lt;p>на всякий случай и для наглядности - diff&lt;/p>
&lt;pre tabindex="0">&lt;code>❯ diff ~/src/Marlin/Configurations/config/examples/Creality/Ender-5\ Pro/CrealityV422/Configuration.h \
~/src/Marlin/Marlin/Marlin/Configuration.h
23,24c23,24
&amp;lt; #error &amp;#34;Don&amp;#39;t build with import-2.1.x configurations!&amp;#34;
&amp;lt; #error &amp;#34;Use the &amp;#39;bugfix...&amp;#39; or &amp;#39;release...&amp;#39; configurations matching your Marlin version.&amp;#34;
---
&amp;gt; // #error &amp;#34;Don&amp;#39;t build with import-2.1.x configurations!&amp;#34;
&amp;gt; // #error &amp;#34;Use the &amp;#39;bugfix...&amp;#39; or &amp;#39;release...&amp;#39; configurations matching your Marlin version.&amp;#34;
26c26
&amp;lt; //#define ENDER5_USE_BLTOUCH
---
&amp;gt; #define ENDER5_USE_BLTOUCH
1352c1352
&amp;lt; #define Z_MIN_PROBE_USES_Z_MIN_ENDSTOP_PIN
---
&amp;gt; //#define Z_MIN_PROBE_USES_Z_MIN_ENDSTOP_PIN
&lt;/code>&lt;/pre>&lt;p>говорят можно еще поправить NOZZLE_TO_PROBE_OFFSET, но я еще не добрался попробовать.&lt;/p>
&lt;p>Далее идем в Auto Build Marlin, жамкаем Build напротив STM32F103RE_creality (512K)
&lt;img src="build-marlin.png" alt="Выглядит примерно вот так">&lt;/p>
&lt;p>в итоге получаем .bin файл который пишем на SD карту, втыкаем в принтер и включаем принтер с этой картой, что приводит к автоматической заливке прошивки.&lt;/p>
&lt;h2 id="калибровки">Калибровки&lt;/h2>
&lt;h3 id="столик">Столик&lt;/h3>
&lt;p>Тут все тупо, как описано в &lt;a href="https://marlinfw.org/docs/features/auto_bed_leveling.html#first-time-bed-leveling">мануале&lt;/a>.
Команды вводим в терминале в octoprint, так проще чем вертеть ручку и выбирать меню. # и все что за ним не вводим, это типа комментарии&lt;/p>
&lt;pre tabindex="0">&lt;code>M111 S247 # включаем дополнительный логинг
G28 # делаем Auto Home
G29 # калибруем уровень столика
M500 # сохраняем все откалиброванное в EEPROM
&lt;/code>&lt;/pre>&lt;p>Пробуем печатать. Скорее всего получим мы паутинку вместо ожидаемой детали потому что BLTouch при калибровке запоминает рельеф стола, но точно выставить расстояние до стола он не может. Это приводит к тому что печать начинается выше чем надо, деталь не крепится дном и елозит по всему столу. Вообще в Marlin есть целый визард (Z-Offset Wizard), но у меня визардом не получилось. В результате разных попыток появились вот такие работающие шаги:&lt;/p>
&lt;ol>
&lt;li>G28 (Auto Home), эта процедура отведет голову по оси Z на +10 мм примерно от 0&lt;/li>
&lt;li>Выводим аккуратно, меняя шаг в сторону уменьшения, голову по оси Z, так что бы между экструдером и столом можно было провести бумажку, но она немного цеплялась. Как в классической ручной калибровке столика винтами снизу, только без винтов. У меня получилось что это было выше нуля и на экране было -1.75.&lt;/li>
&lt;li>В терминале octoprint загоняем двумя строками &amp;lsquo;M851 Z-1.75&amp;rsquo; и &amp;lsquo;M500&amp;rsquo;. В меню z probe offset при этом теперь показывает +1.75&lt;/li>
&lt;/ol>
&lt;p>На этом фсе. Мира и добра всем.&lt;/p>
&lt;p>&lt;img src="drink.png" alt="Фсe !!!">&lt;/p></content></item></channel></rss>