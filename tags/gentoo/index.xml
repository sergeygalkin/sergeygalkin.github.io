<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>gentoo on Всякое</title><link>/tags/gentoo/</link><description>Recent content in gentoo on Всякое</description><generator>Hugo -- gohugo.io</generator><language>ru</language><lastBuildDate>Thu, 16 Nov 2023 20:36:04 +0400</lastBuildDate><atom:link href="/tags/gentoo/index.xml" rel="self" type="application/rss+xml"/><item><title>Simple WiFi pentest</title><link>/posts/wifi-pentest/</link><pubDate>Thu, 16 Nov 2023 20:36:04 +0400</pubDate><guid>/posts/wifi-pentest/</guid><description>Simple WiFi pentest Hardware Orange Pi 5 + TP-Link Archer T2U PLUS [RTL8821AU] The OS is Kali Linux. Don&amp;rsquo;t forget to do rm /boot/*cloud-arm64* &amp;amp;&amp;amp; /usr/sbin/u-boot-update after apt update &amp;amp;&amp;amp; apt upgrade otherwise you can&amp;rsquo;t boot after reboot. In my case, the main reason for the appearance incorrect kernel is apt install wireguard. As you can see
└─# apt depends wireguard wireguard |Depends: &amp;lt;wireguard-modules&amp;gt; (&amp;gt;= 0.0.20191219) linux-image-arm64 linux-image-cloud-arm64 you can use it in any place with powerbank.</description><content>&lt;h1 id="simple-wifi-pentest">Simple WiFi pentest&lt;/h1>
&lt;h2 id="hardware">Hardware&lt;/h2>
&lt;h3 id="orange-pi-5--tp-link-archer-t2u-plus-rtl8821au">Orange Pi 5 + TP-Link Archer T2U PLUS [RTL8821AU]&lt;/h3>
&lt;p>The OS is &lt;a href="https://github.com/leeboby/kali-images">Kali Linux&lt;/a>. Don&amp;rsquo;t forget to do &lt;code>rm /boot/*cloud-arm64* &amp;amp;&amp;amp; /usr/sbin/u-boot-update&lt;/code> after &lt;code>apt update &amp;amp;&amp;amp; apt upgrade&lt;/code> otherwise you can&amp;rsquo;t boot after reboot. In my case, the main reason for the appearance incorrect kernel is &lt;code>apt install wireguard&lt;/code>. As you can see&lt;/p>
&lt;pre tabindex="0">&lt;code>└─# apt depends wireguard
wireguard
|Depends: &amp;lt;wireguard-modules&amp;gt; (&amp;gt;= 0.0.20191219)
linux-image-arm64
linux-image-cloud-arm64
&lt;/code>&lt;/pre>&lt;p>you can use it in any place with powerbank.&lt;/p>
&lt;h3 id="some-computer-with-video-card">Some computer with video card&lt;/h3>
&lt;p>In my case it&amp;rsquo;s Gentoo with GeForce RTX 3070 Lite Hash Rate&lt;/p>
&lt;h2 id="orange-pi-5">Orange PI 5&lt;/h2>
&lt;h3 id="prepare">Prepare&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>apt update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>apt install tshark hcxdumptool hcxtools iw bettercap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="exclude-wlan0-from-nodemanager">Exclude wlan0 from NodeManager&lt;/h3>
&lt;p>Update &lt;code>/etc/NetworkManager/NetworkManager.conf&lt;/code> and restart NetworkManager&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">[main]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">plugins&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">ifupdown,keyfile&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">[ifupdown]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">managed&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">[keyfile]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">unmanaged-devices&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">interface-name:wlan0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="run">Run&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Setup monitor mode&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip link set wlan0 down &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> iw wlan0 set monitor none &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> ip link set wlan0 up
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Run tool for hcxdumptool 6.3.1 (C) 2023 ZeroBeat&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hcxdumptool -i wlan0 -w wlan0.pcapng
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># wait&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can use systemd service like this&lt;/p>
&lt;pre tabindex="0">&lt;code>[Unit]
Description=WiFi scan
[Service]
Type=simple
Environment=TERM=xterm
ExecStartPre=/usr/bin/ip link set wlan0 down
ExecStartPre=/usr/sbin/iw wlan0 set monitor none
ExecStartPre=/usr/bin/ip link set wlan0 up
ExecStartPre=-/usr/bin/bash -c &amp;#39;/usr/bin/mv /var/log/wifi-dump/wlan0.pcapng /var/log/wifi-dump/wlan0-$(date +%%Y%%m%%d-%%H%%M%%S).pcapng&amp;#39;
ExecStart=bash -c &amp;#39;TERM=xterm; /usr/bin/hcxdumptool -i wlan0 -w /var/log/wifi-dump/wlan0.pcapng&amp;#39;
Restart=always
RestartSec=30
[Install]
WantedBy=multi-user.target
&lt;/code>&lt;/pre>&lt;p>After or during waiting&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Dump to hc22000 file format, watch into &amp;#39;PMKID (best)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hcxpcapngtool -o wlan0.hc22000 wlan0.pcapng
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Get info from wlan0.hc22000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hcxhashtool -i wlan0.hc22000 --info&lt;span style="color:#f92672">=&lt;/span>stdout
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can run something like this &lt;code>bettercap -iface wlan0 -eval 'wifi.recon on; set ticker.period 5; set ticker.commands &amp;quot;wifi.show&amp;quot;; ticker on'&lt;/code> at the same time for watching in real time.&lt;/p>
&lt;h2 id="gentoo">Gentoo&lt;/h2>
&lt;h3 id="prepare-1">Prepare&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>eselect repository enable pentoo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eix-sync
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eix-update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>emerge hcxtools
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="try-to-find-something-interesting">Try to find something interesting&lt;/h3>
&lt;p>Simple ans stupid brute force with all digest from 000000000 (minimal wifi password length) to 999999999999 (like mobile phone number)&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>hashcat -m &lt;span style="color:#ae81ff">22000&lt;/span> wlan0.hc22000 -a3 --increment -w3 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --increment-max &lt;span style="color:#ae81ff">11&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --increment-min &lt;span style="color:#ae81ff">8&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> &lt;span style="color:#e6db74">&amp;#39;?d?d?d?d?d?d?d?d?d?d?d&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># press s to check status&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># run any time if you want get current status with the found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hashcat -m &lt;span style="color:#ae81ff">22000&lt;/span> wlan0.hc22000 --show
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>Timings:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>8 digits ~ 18 minutes&lt;/li>
&lt;li>9 digits ~ 3 hours&lt;/li>
&lt;li>10 digits ~ 1 day, 5 hours&lt;/li>
&lt;li>11 digist ~ 12 days, 9 hours&lt;/li>
&lt;/ul></content></item></channel></rss>