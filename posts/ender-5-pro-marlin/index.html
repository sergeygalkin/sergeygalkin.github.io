<!doctype html><html lang=ru><head><title>Index :: Всякое</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Сборка Marlin 2.x для Ender 5 Pro"><meta name=keywords content="хобби,3d печать,ender,ender 5"><meta name=robots content="noodp"><link rel=canonical href=/posts/ender-5-pro-marlin/><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z5MR5322PH"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z5MR5322PH",{anonymize_ip:!1})}</script><link rel=stylesheet href=/style.css><link rel="shortcut icon" href=/img/theme-colors/orange.png><link rel=apple-touch-icon href=/img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="ru"><meta property="og:type" content="article"><meta property="og:title" content="Index"><meta property="og:description" content="Сборка Marlin 2.x для Ender 5 Pro"><meta property="og:url" content="/posts/ender-5-pro-marlin/"><meta property="og:site_name" content="Всякое"><meta property="og:image" content="/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2023-06-01 09:06:16 +0400 +0400"></head><body class=orange><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Всякое</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=/posts/ender-5-pro-marlin/>Index</a></h1><div class=post-meta><time class=post-date>2023-06-01 ::
[Updated :: 2023-06-01]</time>
<span class=post-author>sergeygals</span>
<span class=post-reading-time>:: 3 min read (446 words)</span></div><span class=post-tags>#<a href=/tags/%D1%85%D0%BE%D0%B1%D0%B1%D0%B8/>хобби</a>&nbsp;
#<a href=/tags/3d-%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D1%8C/>3d печать</a>&nbsp;
#<a href=/tags/ender/>ender</a>&nbsp;
#<a href=/tags/ender-5/>ender 5</a>&nbsp;</span><div class=post-content><div><h2 id=исходный-сетап>Исходный сетап<a href=#исходный-сетап class=hanchor arialabel=Anchor>&#8983;</a></h2><ol><li>Ender 5 Pro</li><li><a href=https://octoprint.org/>OctoPrint</a> на Raspberry PI 3</li><li>BL-Touch для принтеров CR-10/CR-10S/CR-10 V2/Ender-3/Ender-3 Pro/Ender-3 V2</li><li>Silent Mainboard Ender-5 Pro v4.22</li></ol><h2 id=подготовка-vscode-platformio-auto-build-marlin>Подготовка (VSCode, PlatformIO, Auto Build Marlin)<a href=#подготовка-vscode-platformio-auto-build-marlin class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Все по мануалу из <a href="https://www.youtube.com/watch?v=_tnVl4X2p20">этого видоса</a></p><h2 id=готовим-исходники>Готовим исходники<a href=#готовим-исходники class=hanchor arialabel=Anchor>&#8983;</a></h2><pre tabindex=0><code>mkdir ~/src/Marlin
git clone https://github.com/MarlinFirmware/Marlin ~/src/Marlin/Marlin
git clone https://github.com/MarlinFirmware/Configurations \
  ~/src/Marlin/Configurations
cd ~/Marlin/
cp Configurations/config/examples/Creality/Ender-5\ Pro/CrealityV422/*  \
  Marlin/Marlin/
</code></pre><p><a href=https://lodge.glasgownet.com/2021/08/17/compiling-marlin-firmware-for-the-ender-5-pro-v4-2-2-board-with-bltouch/>источник</a></p><h2 id=редактируем-и-собираем>Редактируем и собираем<a href=#редактируем-и-собираем class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Открываем ~/src/Marlin/Marlin как PlatformIO как показано в видосике ссылка на который была выше и генерируем среду сборки как там показно.</p><p>в VS Code открываем ~/src/Marlin/Marlin/Marlin/Configuration.h и правим там тупо всего 4 строки</p><ol><li>Комментим два error в начале</li><li>Раcкоменчиваем <code>#define ENDER5_USE_BLTOUCH</code></li><li>Коментим <code>#define Z_MIN_PROBE_USES_Z_MIN_ENDSTOP_PIN</code> (потому что плата 4.2.2 с 5-pin header)</li></ol><p>на всякий случай и для наглядности - diff</p><pre tabindex=0><code>❯ diff ~/src/Marlin/Configurations/config/examples/Creality/Ender-5\ Pro/CrealityV422/Configuration.h  \
  ~/src/Marlin/Marlin/Marlin/Configuration.h
23,24c23,24
&lt; #error &#34;Don&#39;t build with import-2.1.x configurations!&#34;
&lt; #error &#34;Use the &#39;bugfix...&#39; or &#39;release...&#39; configurations matching your Marlin version.&#34;
---
&gt; // #error &#34;Don&#39;t build with import-2.1.x configurations!&#34;
&gt; // #error &#34;Use the &#39;bugfix...&#39; or &#39;release...&#39; configurations matching your Marlin version.&#34;
26c26
&lt; //#define ENDER5_USE_BLTOUCH
---
&gt; #define ENDER5_USE_BLTOUCH
1352c1352
&lt; #define Z_MIN_PROBE_USES_Z_MIN_ENDSTOP_PIN
---
&gt; //#define Z_MIN_PROBE_USES_Z_MIN_ENDSTOP_PIN
</code></pre><p>говорят можно еще поправить NOZZLE_TO_PROBE_OFFSET, но я еще не добрался попробовать.</p><p>Далее идем в Auto Build Marlin, жамкаем Build напротив STM32F103RE_creality (512K)
<img src=build-marlin.png alt="Выглядит примерно вот так"></p><p>в итоге получаем .bin файл который пишем на SD карту, втыкаем в принтер и включаем принтер с этой картой, что приводит к автоматической заливке прошивки.</p><h2 id=калибровки>Калибровки<a href=#калибровки class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=столик>Столик<a href=#столик class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Тут все тупо, как описано в <a href=https://marlinfw.org/docs/features/auto_bed_leveling.html#first-time-bed-leveling>мануале</a>.
Команды вводим в терминале в octoprint, так проще чем вертеть ручку и выбирать меню. # и все что за ним не вводим, это типа комментарии</p><pre tabindex=0><code>M111 S247 # включаем дополнительный логинг
G28 # делаем Auto Home
G29 # калибруем уровень столика
M500 # сохраняем все откалиброванное в EEPROM
</code></pre><p>Пробуем печатать. Скорее всего получим мы паутинку вместо ожидаемой детали потому что BLTouch при калибровке запоминает рельеф стола, но точно выставить расстояние до стола он не может. Это приводит к тому что печать начинается выше чем надо, деталь не крепится дном и елозит по всему столу. Вообще в Marlin есть целый визард (Z-Offset Wizard), но у меня визардом не получилось. В результате разных попыток появились вот такие работающие шаги:</p><ol><li>G28 (Auto Home), эта процедура отведет голову по оси Z на +10 мм примерно от 0</li><li>Выводим аккуратно, меняя шаг в сторону уменьшения, голову по оси Z, так что бы между экструдером и столом можно было провести бумажку, но она немного цеплялась. Как в классической ручной калибровке столика винтами снизу, только без винтов. У меня получилось что это было выше нуля и на экране было -1.75.</li><li>В терминале octoprint загоняем двумя строками &lsquo;M851 Z-1.75&rsquo; и &lsquo;M500&rsquo;. В меню z probe offset при этом теперь показывает +1.75</li></ol><p>На этом фсе. Мира и добра всем.</p><p><img src=drink.png alt="Фсe !!!"></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Читать другие посты</span><hr></div><div class=pagination__buttons><span class="button next"><a href=/posts/termux-/><span class=button__text>Termux</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>